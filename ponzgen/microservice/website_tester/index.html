<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Tester</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="container">
        <header class="my-4">
            <h1 class="text-center">Backend API Tester</h1>
            <p class="text-center lead">Test all endpoints of the Agent API</p>
        </header>

        <div class="row mb-4">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-header">
                        <h5>Authentication</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="jwt-token" class="form-label">JWT Token</label>
                            <input type="text" class="form-control" id="jwt-token" placeholder="Enter your JWT token">
                            <div class="form-text">
                                For testing, you can use any string as a token since the backend is using a bypass flag.
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="api-url" class="form-label">API URL</label>
                            <input type="text" class="form-control" id="api-url" value="http://localhost:8000" placeholder="Enter API URL (port 8000)">
                            <div class="form-text">Used for all API endpoints (agents, tools, invocation, etc.)</div>
                        </div>
                        <button id="save-auth" class="btn btn-primary">Save</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-6 offset-md-3">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Debug Information</h5>
                        <button class="btn btn-sm btn-outline-secondary" id="toggle-debug">Show/Hide</button>
                    </div>
                    <div class="card-body" id="debug-info" style="display: none;">
                        <div class="mb-3">
                            <h6>Current JWT Token:</h6>
                            <pre id="current-token" class="bg-light p-2 rounded">Not set</pre>
                        </div>
                        <div class="mb-3">
                            <h6>Current API URL:</h6>
                            <pre id="current-url" class="bg-light p-2 rounded">Not set</pre>
                        </div>
                        <div class="mb-3">
                            <h6>Authorization Header:</h6>
                            <pre id="auth-header" class="bg-light p-2 rounded">Not set</pre>
                        </div>
                        <div class="alert alert-info">
                            <strong>Note:</strong> The backend is using a bypass flag for authentication. 
                            It doesn't actually validate the JWT token, but it still requires the Authorization header to be present.
                            Any token value will work as long as it's provided in the correct format.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Agents</h5>
                        <p class="card-text">Create, read, update, and delete agents. Add and remove tools from agents.</p>
                        <a href="agents.html" class="btn btn-primary">Go to Agents</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Tools</h5>
                        <p class="card-text">Create, read, update, and delete tools that can be assigned to agents.</p>
                        <a href="tools.html" class="btn btn-primary">Go to Tools</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Agent Logs</h5>
                        <p class="card-text">View and manage agent logs. Set parameters for logging.</p>
                        <a href="agent-logs.html" class="btn btn-primary">Go to Agent Logs</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Avatar Management</h5>
                        <p class="card-text">Manage and customize avatars for both tools and agents.</p>
                        <div class="d-flex gap-2">
                            <a href="tools-avatar.html" class="btn btn-primary">Tools Avatars</a>
                            <!-- <a href="agents-avatar.html" class="btn btn-primary">Agents Avatars</a> -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Companies</h5>
                        <p class="card-text">Manage companies and their users.</p>
                        <a href="companies.html" class="btn btn-primary">Go to Companies</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Roles</h5>
                        <p class="card-text">View available roles in the system.</p>
                        <a href="roles.html" class="btn btn-primary">Go to Roles</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Agent Invoke</h5>
                        <p class="card-text">Test invoking agents with custom inputs and parameters.</p>
                        <a href="agent-invoke.html" class="btn btn-primary">Go to Agent Invoke</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Agent Invoke Stream</h5>
                        <p class="card-text">Test invoking agents with streaming responses in real-time.</p>
                        <a href="agent-invoke-stream.html" class="btn btn-primary">Go to Agent Invoke Stream</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Agent Creator</h5>
                        <p class="card-text">Create new agents with prompt.</p>
                        <a href="agent-creator.html" class="btn btn-primary">Go to Agent Creator</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Health Check</h5>
                        <p class="card-text">Test API connectivity and diagnose CORS issues.</p>
                        <a href="health.html" class="btn btn-primary">Go to Health Check</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Feature Sharing</h5>
                        <p class="card-text">Share agents and conversations with others using public links or email access.</p>
                        <a href="feature-sharing.html" class="btn btn-primary">Go to Feature Sharing</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Avatar Management</h5>
                        <p class="card-text">Manage and customize avatars for both tools and agents.</p>
                        <div class="d-flex gap-2">
                            <a href="tools-avatar.html" class="btn btn-primary">Tools Avatars</a>
                            <!-- <a href="agents-avatar.html" class="btn btn-primary">Agents Avatars</a> -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">Chat Recommendations</h5>
                        <p class="card-text">Get AI-powered chat recommendations and suggestions for your conversations.</p>
                        <a href="chat-recommendation.html" class="btn btn-primary">Go to Chat Recommendations</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title">User Info</h5>
                        <p class="card-text">View information about the authenticated user.</p>
                        <a href="user-info.html" class="btn btn-primary">Go to User Info</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved auth data
            const jwtToken = localStorage.getItem('jwt_token');
            const apiUrl = localStorage.getItem('api_url');
            
            if (jwtToken) {
                document.getElementById('jwt-token').value = jwtToken;
                document.getElementById('current-token').textContent = jwtToken;
            }
            
            if (apiUrl) {
                document.getElementById('api-url').value = apiUrl;
                document.getElementById('current-url').textContent = apiUrl;
            }
            
            // Update auth header display
            updateAuthHeader();
            
            // Save auth data
            document.getElementById('save-auth').addEventListener('click', function() {
                const jwtToken = document.getElementById('jwt-token').value;
                const apiUrl = document.getElementById('api-url').value;
                
                localStorage.setItem('jwt_token', jwtToken);
                localStorage.setItem('api_url', apiUrl);
                
                // Update debug info
                document.getElementById('current-token').textContent = jwtToken;
                document.getElementById('current-url').textContent = apiUrl;
                updateAuthHeader();
                
                alert('Authentication data saved!');
            });
            
            // Toggle debug info
            document.getElementById('toggle-debug').addEventListener('click', function() {
                const debugInfo = document.getElementById('debug-info');
                debugInfo.style.display = debugInfo.style.display === 'none' ? 'block' : 'none';
            });
        });
        
        // Update auth header display
        function updateAuthHeader() {
            const jwtToken = localStorage.getItem('jwt_token');
            if (jwtToken) {
                document.getElementById('auth-header').textContent = `Authorization: Bearer ${jwtToken}`;
            } else {
                document.getElementById('auth-header').textContent = 'Not set';
            }
        }
    </script>
</body>
</html>